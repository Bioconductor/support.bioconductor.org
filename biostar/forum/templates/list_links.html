{% extends "forum_list.html" %}
{% load forum_tags %}
{% load static %}
{% load humanize %}
{% load cache %}

{% block title %}
    Bioinformatics Answers
{% endblock %}

{% block headtitle %}
    Bioinformatics Answers
{% endblock %}

{% block body %}

    <div class="ui vertical segment">

        <h2 class="ui header">
            <img src="{% static 'images/news-herald.png' %}">
            <div class="content">
                Biostar Herald
                <div class="sub header">Share bioinformatics resources from across the web.</div>
            </div>
        </h2>

        <a class="muted" href="#" id="planet_suggest"><i class="pencil alternate icon"></i> Share</a>
             &bull;
             <a class="muted" href="{% url 'list_links' %}"> New </a>
        &bull;

            <a class="muted" href="{% url 'list_links' %}?status=published"> Published </a>
            &bull;

            <a class="muted" href="{% url 'list_links' %}?status=rejected"> Rejected </a>



    </div>

    <div class="ui segment links-form form-wrap">

        <form method="post" class="ui form" action="{% url 'list_links' %}">
            {% form_errors form %}

            {% csrf_token %}

            <div class="required field">
                <label>Link to suggest</label>
                {{ form.url }}
            </div>

            <div class="required field">
                <label>Link description</label>
                {{ form.text }}
            </div>

            <button type="submit" class="ui submit green button">
                <i class="check icon"></i>Submit
            </button>

            <a class="ui button cancel">
                <i class="undo icon"></i>Cancel
            </a>
        </form>

    </div>
    <div class="ui vertical segment">
        <h4 class="ui header">{{ status|capfirst }} Stories</h4>

        <div class="ui relaxed divided list">

            {% for link in links %}
                <div class="item">
                    <img class="ui avatar image" src="{% gravatar user=link.user size=80 %}"/>
                    <div class="content">
                        <em>{{ link.date|naturaltime }}</em> &bull;
                        <a href="{{ link.user.profile.get_absolute_url }}">{{ link.user.profile.name }}</a>
                        suggested
                        <a href="{{ link.url }}">{{ link.url }}</a>
                        {% if user.profile.is_moderator %}

                            {% if link.rejected or link.new %}
                                &bull;
                                <a class="muted" href="{% url "publish_link" link.id %}">
                                    <i class="green check circle icon"></i>
                                    Publish</a>
                            {% endif %}

                            {% if link.published  or link.new%}
                                <a class="muted" href="{% url "reject_link" link.id %}">
                                    <i class="red times icon"></i>
                                    Reject</a>
                            {% endif %}

                        {% endif %}

                        {% if link.text %}
                            <p class="muted">
                                {{ link.text|truncatechars:100 }}
                            </p>
                        {% endif %}

                    </div>
                </div>
            {% empty %}
                <div class="ui blue message">No results found.</div>
            {% endfor %}

        </div>
    </div>

{% endblock %}

{% block sidebar %}

    <h4>Planet Feeds</h4>

    {% for blog in blogs %}
        <div class="blog-feed">
            <h5><a href="{{ blog.link }}">{{ blog.title }}</a></h5>
            <div>{{ blog.desc|safe }}</div>
            <div class="muted">{{ blog.count }} post{{ blog.count|pluralize }} - last
                updated {{ blog.updated_date|timesince }} ago
            </div>
        </div>
        <div class="ui divider"></div>
    {% endfor %}



{% endblock %}